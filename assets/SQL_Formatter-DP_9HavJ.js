import{d as A,Z as B,j as C,p as M,o as b,c as g,f as p,e as x,l as v,v as N,w,M as d}from"./index-uOoKXyBm.js";import{ar as S,aq as H}from"./Button-DNitYZWK.js";const V={class:"p-4"},z={key:0},F={key:1},O={id:"toppart"},P={id:"formatted_code",class:"jush-sql"},D=["innerHTML"],E=A({__name:"SQL_Formatter",setup(I){const{text:Q,copy:y,copied:T,isSupported:R}=B(),_=C(null),c=C(null);function h(s=""){return s.replace(/<[^>]*>/g,"").replaceAll("&lt;","<").replaceAll("&gt;",">")}const L=M(()=>h(c==null?void 0:c.value));var r=0,u=4,$=70,m=null;function q(){m!=null&&clearTimeout(m),m=setTimeout(k,1)}function j(s){s=s.replace(/\n\s*\n/g,"\n"),s=s.replace(/^[\s\n]*/,""),s=s.replace(/[\s\n]*$/,""),c.value=jush.highlight("sql",s),r=0}function a(){for(var s="",e=0;e<r;e++)for(var i=0;i<u;i++)s+=" ";return s}function k(){m=null;var s=_.value;s[0]=="\n"&&(s=s.substr(1)),s=s.replace(/[	 ]+/g," "),s=s.replace(/\s?([;:{},+>])\s?/g,"$1"),s=s.replace(/\{(.*):(.*)\}/g,"{$1: $2}");for(var e=a(),i=r,f=!1,n,o=!0,l=0,t=0;t<s.length;t++)if(n=s.charAt(t),f)f==n&&(f=!1),e+=n,l++,o=!1;else if(n=="(")s.substr(t,3)=="(+)"?(e+="(+)",t+=2,l+=3,o=!1):(e+="\n"+a()+"(\n",r++,e+=a(),l=u*r,o=!0);else if(s.substr(t,2)=="/*"){for(t+=2,e+="/*";s.substr(t,2)!="*/";)e+=s.charAt(t++),l++;t++,e+="*/",l+=4}else s.substr(t,5).toLowerCase()==" from"?(e+="\n"+a()+s.substr(t+1,4),t+=4,l=u*r+4,o=!1):s.substr(t,6).toLowerCase()==" where"?(e+="\n"+a()+s.substr(t+1,5),t+=5,l=u*r+5,o=!1):s.substr(t,4).toLowerCase()==" and"?(e+="\n"+a()+s.substr(t+1,3),t+=3,l=u*r+3,o=!1):s.substr(t,3).toLowerCase()==" or"?(e+="\n"+a()+s.substr(t+1,2),t+=2,l=u*r+2,o=!1):n==")"?(e=e.replace(/\s*$/,""),r--,e+="\n"+a()+")",l=u*r+1,o=!1):n=='"'||n=="'"?(f&&n==f?f=!1:f=n,e+=n,l++,o=!1):n==","?(e+=",\n"+a(),l=u*r,o=!0):n=="\n"?(e+="\n"+a(),l=u*r,o=!0):n==" "?o||(l>$?(e+="\n"+a(),o=!0,l=u*r):e+=" "):(e+=n,l++,o=!1);r=i,e=e.replace(/[\s\n]*$/,""),j(e)}return(s,e)=>{const i=S,f=H;return b(),g("div",V,[p("div",null,[x(i,{value:v(_),"onUpdate:value":e[0]||(e[0]=n=>N(_)?_.value=n:null),type:"textarea",placeholder:"sql",onChange:q},null,8,["value"]),x(f,{onClick:e[1]||(e[1]=n=>{v(L),v(y)(v(L))}),type:"info",class:"text-16px",size:"large"},{icon:w(()=>e[2]||(e[2]=[p("span",{class:"i-mdi:content-copy"},null,-1)])),default:w(()=>[e[3]||(e[3]=d(" 复制")),v(T)?(b(),g("span",F,"Copied!")):(b(),g("span",z,"Copy"))]),_:1})]),p("div",O,[p("pre",null,[e[6]||(e[6]=d("				")),p("code",P,[e[4]||(e[4]=d("\n					")),p("div",{innerHTML:v(c)},null,8,D),e[5]||(e[5]=d("\n				"))]),e[7]||(e[7]=d("\n			"))])])])}}}),G=Object.freeze(Object.defineProperty({__proto__:null,default:E},Symbol.toStringTag,{value:"Module"}));export{G as _};
