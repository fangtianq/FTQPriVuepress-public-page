import{d as M,$ as S,j as b,p as B,o as C,c as A,f as v,e as L,l as p,v as w,M as c,w as T}from"./index-KCs8WztR.js";import{ar as N,aq as E}from"./Button-DIh1Xk2F.js";const H={class:"p-4"},V={key:0},z={key:1},O={id:"toppart"},P={id:"formatted_code",class:"jush-sql"},Q=["innerHTML"],U=M({__name:"SQL_Formatter",setup(I){const{text:R,copy:$,copied:h,isSupported:G}=S(),m=b(null),g=b(""),d=b(null);function D(t=""){return t.replace(/<[^>]*>/g,"").replaceAll("&lt;","<").replaceAll("&gt;",">")}const x=B(()=>D(d==null?void 0:d.value));var a=0,f=4,F=70,_=null;function y(){_!=null&&clearTimeout(_),_=setTimeout(q,1)}function j(t){t=t.replace(/\n\s*\n/g,"\n"),t=t.replace(/^[\s\n]*/,""),t=t.replace(/[\s\n]*$/,"");const e=g.value;d.value=jush.highlight("sql",k(t,(e==null?void 0:e.replaceAll("(String)","").replaceAll(", ",",")).split(","))),a=0}function k(t,e){let u=t.split("?");for(let n=0;n<u.length-1;n++){let s="";try{s=e[n]||""}catch(o){}u[n]+="'"+s+"'",u[n]+="-- 替换?[".concat(n,"]")}return u.join("")}function i(){for(var t="",e=0;e<a;e++)for(var u=0;u<f;u++)t+=" ";return t}function q(){_=null;var t=m.value;t[0]=="\n"&&(t=t.substr(1)),t=t.replace(/[	 ]+/g," "),t=t.replace(/\s?([;:{},+>])\s?/g,"$1"),t=t.replace(/\{(.*):(.*)\}/g,"{$1: $2}");for(var e=i(),u=a,n=!1,s,o=!0,r=0,l=0;l<t.length;l++)if(s=t.charAt(l),n)n==s&&(n=!1),e+=s,r++,o=!1;else if(s=="(")t.substr(l,3)=="(+)"?(e+="(+)",l+=2,r+=3,o=!1):(e+="\n"+i()+"(\n",a++,e+=i(),r=f*a,o=!0);else if(t.substr(l,2)=="/*"){for(l+=2,e+="/*";t.substr(l,2)!="*/";)e+=t.charAt(l++),r++;l++,e+="*/",r+=4}else t.substr(l,5).toLowerCase()==" from"?(e+="\n"+i()+t.substr(l+1,4),l+=4,r=f*a+4,o=!1):t.substr(l,6).toLowerCase()==" where"?(e+="\n"+i()+t.substr(l+1,5),l+=5,r=f*a+5,o=!1):t.substr(l,4).toLowerCase()==" and"?(e+="\n"+i()+t.substr(l+1,3),l+=3,r=f*a+3,o=!1):t.substr(l,3).toLowerCase()==" or"?(e+="\n"+i()+t.substr(l+1,2),l+=2,r=f*a+2,o=!1):s==")"?(e=e.replace(/\s*$/,""),a--,e+="\n"+i()+")",r=f*a+1,o=!1):s=='"'||s=="'"?(n&&s==n?n=!1:n=s,e+=s,r++,o=!1):s==","?(e+=",\n"+i(),r=f*a,o=!0):s=="\n"?(e+="\n"+i(),r=f*a,o=!0):s==" "?o||(r>F?(e+="\n"+i(),o=!0,r=f*a):e+=" "):(e+=s,r++,o=!1);a=u,e=e.replace(/[\s\n]*$/,""),j(e)}return(t,e)=>{const u=N,n=E;return C(),A("div",H,[v("div",null,[L(u,{value:p(m),"onUpdate:value":e[0]||(e[0]=s=>w(m)?m.value=s:null),type:"textarea",placeholder:"sql",onChange:y},null,8,["value"]),e[5]||(e[5]=c(" 参数： ")),L(u,{value:p(g),"onUpdate:value":e[1]||(e[1]=s=>w(g)?g.value=s:null),type:"textarea",placeholder:"填入参数，例如：5D877897-FD3E-44AC-9096-D3FA9A948CA7, 5D877897-FD3E-44AC-9096-D3FA9A948CA7",onChange:y},null,8,["value"]),L(n,{onClick:e[2]||(e[2]=s=>{p(x),p($)(p(x))}),type:"info",class:"text-16px",size:"large"},{icon:T(()=>e[3]||(e[3]=[v("span",{class:"i-mdi:content-copy"},null,-1)])),default:T(()=>[e[4]||(e[4]=c(" 复制")),p(h)?(C(),A("span",z,"Copied!")):(C(),A("span",V,"Copy"))]),_:1})]),v("div",O,[v("pre",null,[e[8]||(e[8]=c("				")),v("code",P,[e[6]||(e[6]=c("\n					")),v("div",{innerHTML:p(d)},null,8,Q),e[7]||(e[7]=c("\n				"))]),e[9]||(e[9]=c("\n			"))])])])}}}),W=Object.freeze(Object.defineProperty({__proto__:null,default:U},Symbol.toStringTag,{value:"Module"}));export{W as _};
